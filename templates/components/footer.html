<footer class="iq-footer" role="contentinfo">
  <style>

    :root[data-theme="dim"]{
  --bg:#0f1113;
  --surface:#111418;
  --ink:#EDEFF1;
  --muted:#9aa0a6;
  --hairline:#1f2328;
  --shadow:0 10px 22px rgba(0,0,0,.35);
}
body[data-theme="dim"], :root[data-theme="dim"] body{
  background:var(--bg);
  color:var(--ink);
}
    /* ===== InventoryIQ Footer (scoped) ===== */
    .iq-footer{margin-top:36px;border-top:1px solid var(--hairline);background:#fff}
    .iqf-inner{max-width:var(--container);margin:0 auto;padding:24px;display:grid;grid-template-columns:repeat(12,1fr);gap:22px}
    .iqf-brand{grid-column:span 4;display:flex;gap:12px}
    .iqf-brand img{width:42px;height:auto}
    .iqf-blurb{color:#34383c}
    .iqf-pills{display:flex;gap:6px;flex-wrap:wrap;margin-top:8px}
    .iqf-pill{padding:4px 8px;border:1px solid var(--hairline);border-radius:999px;background:#fff;font-size:12px;color:#555}
    .iqf-actions{display:flex;gap:8px;margin-top:10px}
    .iqf-btn{padding:8px 12px;border-radius:10px;border:1px solid var(--hairline);background:#fff;font-weight:700}
    .iqf-btn.primary{background:var(--accent);border-color:var(--accent);color:#fff}
    .iqf-btn.ghost{background:#fff}
    .iqf-col{grid-column:span 4}
    .iqf-title{font-size:14px;text-transform:uppercase;letter-spacing:.6px;color:#6b7075;margin:0 0 8px}
    .iqf-list{list-style:none;margin:0;padding:0;display:grid;gap:8px}
    .iqf-list a{color:var(--ink);text-decoration:none}
    .iqf-list a:hover{opacity:.9}
    .iqf-list .active{border-bottom:2px solid #000}
    .iqf-news{grid-column:span 4}
    .iqf-news form{display:flex;gap:8px;margin-top:8px}
    .iqf-news input[type="email"]{flex:1 1 auto;padding:10px 12px;border:1px solid var(--hairline);border-radius:10px}
    .iqf-note{font-size:12px;color:var(--muted);margin-top:6px}
    .iqf-social{display:flex;gap:10px;margin-top:10px}
    .iqf-icon{width:36px;height:36px;border:1px solid var(--hairline);border-radius:50%;display:inline-flex;align-items:center;justify-content:center}
    .iqf-icon svg{width:18px;height:18px;color:#6b6f74}

    .iqf-sub{border-top:1px solid var(--hairline);margin-top:18px}
    .iqf-subbar{max-width:var(--container);margin:0 auto;padding:12px 24px;display:flex;flex-wrap:wrap;gap:12px;align-items:center;justify-content:space-between}
    .iqf-left{display:flex;gap:12px;align-items:center;flex-wrap:wrap}
    .iqf-meta{font-size:12px;color:var(--muted)}
    .iqf-kbd{border:1px solid var(--hairline);border-bottom-width:2px;border-radius:8px;padding:2px 6px;background:#fff;color:#555;font-family:ui-monospace,SFMono-Regular,Menlo,monospace;font-size:12px}
    .iqf-status{padding:2px 8px;border-radius:999px;border:1px solid var(--hairline);background:#fff;font-size:12px;color:#12B76A}
    .iqf-right{display:flex;gap:10px;align-items:center}
    .iqf-toggle{padding:6px 10px;border:1px solid var(--hairline);border-radius:999px;background:#fff;font-weight:700}

    .iqf-top{position:fixed;right:18px;bottom:18px;z-index:900;display:none}
    .iqf-top button{width:44px;height:44px;border-radius:50%;border:1px solid var(--hairline);background:#fff;box-shadow:var(--shadow);display:inline-flex;align-items:center;justify-content:center}
    .iqf-top svg{width:18px;height:18px}

    @media (max-width:900px){ .iqf-brand{grid-column:span 12} .iqf-col{grid-column:span 6} .iqf-news{grid-column:span 6} }
    @media (max-width:640px){ .iqf-col, .iqf-news{grid-column:span 12} }
  </style>

  <div class="iqf-inner">
    <!-- Brand / pitch -->
    <div class="iqf-brand">
      <img src="{{ url_for('static', filename='favicon.svg') }}" alt="InventoryIQ">
      <div class="iqf-blurb">
        <strong>InventoryIQ</strong><br>
        Photograph a box → get a searchable catalog with names, images, and value hints.
        <div class="iqf-pills">
          <span class="iqf-pill">Private by default</span>
          <span class="iqf-pill">Lightning fast</span>
          <span class="iqf-pill">Cmd/Ctrl + K</span>
        </div>
        <div class="iqf-actions">
          <a class="iqf-btn ghost" href="{{ url_for('search.search') }}">Search</a>
          <a class="iqf-btn primary" href="{{ url_for('boxes.new_box') }}">New Box</a>
        </div>
      </div>
    </div>

    <!-- Sitemap 1 -->
    <div class="iqf-col">
      <h3 class="iqf-title">Product</h3>
      <ul class="iqf-list">
        <li><a class="{% if request.endpoint and request.endpoint.startswith('boxes.') %}active{% endif %}" href="{{ url_for('boxes.index') }}">Boxes</a></li>
        <li><a class="{% if request.endpoint and request.endpoint.startswith('search.') %}active{% endif %}" href="{{ url_for('search.search') }}">Search</a></li>
        <li><a class="{% if request.endpoint == 'boxes.new_box' %}active{% endif %}" href="{{ url_for('boxes.new_box') }}">Create a Box</a></li>
        <li><a class="{% if request.endpoint == 'main.about' %}active{% endif %}" href="{{ url_for('main.about') }}">About</a></li>
      </ul>
    </div>

    <!-- Sitemap 2 -->
    <div class="iqf-col">
      <h3 class="iqf-title">Resources</h3>
      <ul class="iqf-list">
        <li><a href="{{ url_for('main.about') }}#faq">FAQ</a></li>
        <li><a href="#" id="openPalette">Command Palette <span class="iqf-kbd">⌘/Ctrl</span> + <span class="iqf-kbd">K</span></a></li>
        <li><a href="#" id="exportCSV">Export CSV</a></li>
        <li><a href="#" id="feedbackLink">Send feedback</a></li>
      </ul>
    </div>

    <!-- Newsletter -->
    <div class="iqf-news">
      <h3 class="iqf-title">Stay in the loop</h3>
      <p class="iqf-note">Tiny updates. No spam. Unsubscribe anytime.</p>
      <form id="iqf-news-form" novalidate>
        <input id="iqf-email" type="email" name="email" placeholder="you@example.com" aria-label="Email address">
        <button class="iqf-btn" id="iqf-subscribe" type="submit">Subscribe</button>
      </form>
      <div class="iqf-note" id="iqf-news-msg" aria-live="polite"></div>

      <div class="iqf-social" aria-label="Social links">
        <a class="iqf-icon" href="#" aria-label="GitHub (coming soon)">
          <svg viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M12 .5a12 12 0 00-3.79 23.4c.6.11.82-.26.82-.57v-2.2c-3.34.73-4.04-1.61-4.04-1.61-.55-1.41-1.34-1.79-1.34-1.79-1.09-.75.08-.74.08-.74 1.21.09 1.85 1.25 1.85 1.25 1.07 1.84 2.81 1.31 3.5 1 .11-.78.42-1.31.76-1.61-2.66-.3-5.46-1.33-5.46-5.93 0-1.31.47-2.38 1.24-3.22-.12-.3-.54-1.53.12-3.18 0 0 1.01-.32 3.3 1.23a11.43 11.43 0 016 0c2.29-1.55 3.3-1.23 3.3-1.23.66 1.65.24 2.88.12 3.18.77.84 1.24 1.91 1.24 3.22 0 4.61-2.8 5.62-5.47 5.93.43.38.81 1.12.81 2.25v3.33c0 .32.21.69.83.57A12 12 0 0012 .5z"/></svg>
        </a>
        <a class="iqf-icon" href="#" aria-label="Twitter/X (coming soon)">
          <svg viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M18.244 2H21l-6.5 7.43L22.5 22h-5.656l-4.41-5.758L6.17 22H3.414l7-8L1.5 2h5.742l3.999 5.332L18.244 2zm-1.978 18h1.873L7.85 4h-1.9l10.316 16z"/></svg>
        </a>
      </div>
    </div>
  </div>

  <!-- Sub-bar -->
  <div class="iqf-sub">
    <div class="iqf-subbar">
      <div class="iqf-left">
        <span class="iqf-meta">© <span id="year"></span> InventoryIQ</span>
        <span class="iqf-meta">Build: <span class="mono">{{ app_version|default('local') }}</span></span>
        <span class="iqf-status" id="statusPill">● Online</span>
        <span class="iqf-meta">Shortcuts: <span class="iqf-kbd">/</span> search, <span class="iqf-kbd">⌘/Ctrl</span>+<span class="iqf-kbd">K</span> palette</span>
      </div>
      <div class="iqf-right">
        <button class="iqf-toggle" id="themeToggle" type="button">Theme: <span id="themeName">Light</span></button>
        <a class="iqf-btn ghost" href="{{ url_for('boxes.index') }}">Back to Boxes</a>
      </div>
    </div>
  </div>

  <!-- Back to top -->
  <div class="iqf-top" id="backTop">
    <button aria-label="Back to top">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
        <path d="M12 19V5m0 0l-6 6m6-6l6 6"/>
      </svg>
    </button>
  </div>

  <script>
    (function(){
      /* Current year */
      const y = document.getElementById('year');
      if (y) y.textContent = new Date().getFullYear();

      /* Back to top */
      const topWrap = document.getElementById('backTop');
      const showTop = () => {
        if (window.scrollY > 300) topWrap.style.display = 'block';
        else topWrap.style.display = 'none';
      };
      window.addEventListener('scroll', showTop, {passive:true});
      showTop();
      topWrap?.querySelector('button')?.addEventListener('click', () => window.scrollTo({top:0, behavior:'smooth'}));

      /* Command palette opener */
      const pal = document.getElementById('cmdk');
      document.getElementById('openPalette')?.addEventListener('click', (e) => {
        e.preventDefault();
        pal?.classList.add('is-open');
        document.getElementById('cmdk-input')?.focus();
      });

      /* Fake CSV export hook (replace with real endpoint later) */
      document.getElementById('exportCSV')?.addEventListener('click', (e) => {
        e.preventDefault();
        alert('Hook this up to your export route or command palette action.');
      });

      /* Feedback shortcut */
      document.getElementById('feedbackLink')?.addEventListener('click', (e) => {
        e.preventDefault();
        const mail = 'mailto:feedback@example.com?subject=InventoryIQ%20Feedback';
        window.location.href = mail;
      });

      /* Newsletter (front-end only) */
      const form = document.getElementById('iqf-news-form');
      form?.addEventListener('submit', (e) => {
        e.preventDefault();
        const email = (document.getElementById('iqf-email')?.value || '').trim();
        const msg = document.getElementById('iqf-news-msg');
        const ok = /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
        if (!ok) { msg.textContent = 'Please enter a valid email.'; return; }
        try { localStorage.setItem('iq.news.email', email); } catch(_){}
        msg.textContent = 'Subscribed! (Stored locally for now.)';
        form.reset();
      });

      /* Theme toggle (Light/Dim) */
      const TKEY = 'iq.theme';
      const btn = document.getElementById('themeToggle');
      const nameEl = document.getElementById('themeName');
      function setTheme(t){
        document.documentElement.dataset.theme = t; // you can use [data-theme="dim"] in CSS later
        nameEl.textContent = t === 'dim' ? 'Dim' : 'Light';
        try { localStorage.setItem(TKEY, t); } catch(_){}
      }
      const saved = localStorage.getItem(TKEY) || 'light';
      setTheme(saved);
      btn?.addEventListener('click', () => setTheme((document.documentElement.dataset.theme === 'dim') ? 'light' : 'dim'));

      /* Tiny status pill (stub) */
      const pill = document.getElementById('statusPill');
      // If you have a /health route, you can fetch it here and colorize:
      // fetch('/health').then(()=>pill.textContent='● Online').catch(()=>{pill.textContent='● Offline'; pill.style.color='#b42318';});
    })();
  </script>
</footer>
